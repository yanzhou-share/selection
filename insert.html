<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" >

<head>

    <title>JS在文本域鼠标指定位置插入文本</title>

</head>

<body>

<script>





 function insertAtCursor(myField, myValue) {  

     //IE support  

     if (document.selection) {  

         myField.focus();  

         sel = document.selection.createRange();  

         sel.text = myValue;  

         sel.select();  

     }  

     //MOZILLA/NETSCAPE support  

     else if (myField.selectionStart || myField.selectionStart == '0') {  

         var startPos = myField.selectionStart;  

         var endPos = myField.selectionEnd;  

         // save scrollTop before insert  

         var restoreTop = myField.scrollTop;  

         myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length);  

         if (restoreTop > 0) {  

         myField.scrollTop = restoreTop;  

         }  

         myField.focus();  

         myField.selectionStart = startPos + myValue.length;  

         myField.selectionEnd = startPos + myValue.length;  

     } else {  

         myField.value += myValue;  

         myField.focus();  

     }  

 }  

</script>

<textarea id="aa" style="width: 386px; height: 260px">



</textarea>

<input type="button" onclick="insertAtCursor(document.getElementById('aa'),'asas')" />

</body>

</html>
